# Webアプリ仕様書

## 1. 概要

献立をアシストするアプリ。
テキストボックスに入力された条件および材料から、LLMを用いて、一食分の献立を作成し表示する。
出力された献立及びは入力はチャット形式で表示される。
上記に加えて、献立を見やすくした献立履歴機能、献立から必要材料を取り出した買い物リスト機能、調理時間・ジャンルによる条件絞り込みボタンがある。

## 2. 主な機能

### 2.1 入出力フォーム機能
- テキストエリアでユーザーが質問・指示を入力。
- 2.2 生成AIリクエストAPIを実行し、応答を取得する。
- 同一画面上のチャット欄にユーザー入力とLLMの回答を表示する。
- チャット形式であるため、出力された献立をさかのぼることができる。

### 2.2 生成AIリクエスト API
- ユーザー入力と献立を出力させるためのプロンプトおよびクリックされたボタン(2.5)の内容を合成し、LLMに渡すコンテキストを生成
- OpenRouter経由でLLM（anthropic/claude-3.5-haiku-20241022）へリクエスト
- 応答をJSON形式でフロントエンドに返す。

### 2.3 献立を見やすくする献立履歴機能
- 出力された献立をチャット画面より見やすく表示
- 材料を見ること、材料を買い物リストに追加することができる

### 2.4 献立から必要材料を取り出した買い物リスト機能
- 献立履歴から作りたい献立の材料が追加される
- 複数の献立分の材料が追加された場合、合計量が表示される
- 買い物リスト内の材料を一つずつ消すこと、および一度にすべて消すことができる

### 2.5 調理時間・ジャンルによる条件絞り込みボタン
- 調理時間(15,30,45,60分)とジャンル(和食、洋食、中華)をボタンから簡単に条件に追加することができる

## 3. 使用技術

| 分類         | 技術・ライブラリ |
|--------------|------------------|
| フロントエンド | Vue.js / HTML5 + CSS3 |
| バックエンド  | Flask |
| 通信方式     | Fetch API / JSON |
| LLMモデル    | OpenRouter API（anthropic/claude-3.5-haiku-20241022） |

## 4. 入出力例

### 入力
- ユーザー入力：「暑い日にぴったりの、さっぱりした和食」

- 付与コンテキスト：入力されたテキスト（材料または条件）に基づいて一食分の献立を作成してください。応答には次の指定されるものだけにしてください。必ず「献立名：(ここに献立名)」という行と、約80文字での献立の説明の行と、材料リストを記述した以下の形式のJSONコードブロックを含めてください。\n\n```json\n{\n  \"材料\": [\n    {\"材料名\": \"材料の名前\", \"分量\": \"材料の分量\"}\n  ]\n}\n```

### 出力

- 出力例：
献立名：夏の冷やし膳

暑い夏に食欲がない時でも食べやすい、冷たい料理を中心とした和食の献立です。さっぱりとした味わいで、涼しさを感じられます。

```json
{
  "材料": [
    {"材料名": "冷奴", "分量": "1/2丁"},
    {"材料名": "ミョウガ", "分量": "2個"},
    {"材料名": "大葉", "分量": "5枚"},
    {"材料名": "かつお節", "分量": "適量"},
    {"材料名": "めんつゆ", "分量": "適量"},
    {"材料名": "冷やしうどん", "分量": "1玉"},
    {"材料名": "きゅうり", "分量": "1/2本"},
    {"材料名": "トマト", "分量": "1/2個"},
    {"材料名": "だし汁", "分量": "200ml"},
    {"材料名": "醤油", "分量": "大さじ1"},
    {"材料名": "みりん", "分量": "大さじ1"},
    {"材料名": "酢", "分量": "大さじ1"},
    {"材料名": "白ごま", "分量": "少々"}
  ]
}
```
